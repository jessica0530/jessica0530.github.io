---
layout: post
title: SQL语法
categories: [sql]
description: SQL语法
keywords: sql
---

###HIVE SQL语法

LAG(col,n,DEFAULT) 用于统计窗口内往上第n行值

第一个参数为列名，
第二个参数为往上第n行（可选，默认为1），
第三个参数为默认值（当往上第n行为NULL时候，取默认值，如不指定，则为NULL）


``select 
    cookieid, 
    createtime, 
    url, 
    row_number() over (partition by cookieid order by createtime) as rn, 
    LAG(createtime,1,'1970-01-01 00:00:00') over (partition by cookieid order by createtime) as last_1_time, 
    LAG(createtime,2) over (partition by cookieid order by createtime) as last_2_time 
  from cookie.cookie4;
  
 ``
 
与LAG相反

LEAD(col,n,DEFAULT) 用于统计窗口内往下第n行值

第一个参数为列名，
第二个参数为往下第n行（可选，默认为1），
第三个参数为默认值（当往下第n行为NULL时候，取默认值，如不指定，则为NULL）

 
 ``
 与LAG相反
 
 LEAD(col,n,DEFAULT) 用于统计窗口内往下第n行值
 
 第一个参数为列名，
 第二个参数为往下第n行（可选，默认为1），
 第三个参数为默认值（当往下第n行为NULL时候，取默认值，如不指定，则为NULL）
 ``
 
###last value

``
select 
  cookieid, 
  createtime, 
  url, 
  row_number() over (partition by cookieid order by createtime) as rn, 
  last_value(url) over (partition by cookieid order by createtime) as last1 
from cookie.cookie4;
``




